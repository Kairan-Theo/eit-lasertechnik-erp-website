import{R as N,j as t,a as i,A as l}from"./index-BS0Ij8SW.js";import{c as u,N as k}from"./navigation-DW0cn6Qn.js";import{L as y}from"./language-context-BfcVNXdW.js";/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f=u("CheckCheck",[["path",{d:"M18 6 7 17l-5-5",key:"116fxf"}],["path",{d:"m22 10-7.5 7.5L13 16",key:"ke71qq"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p=u("Trash",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]]);function C(){const[o,n]=i.useState([]),[h,E]=i.useState(""),[g,c]=i.useState(!1),r=async()=>{try{const e=localStorage.getItem("authToken");if(!e)return;const a=await fetch(`${l}/api/notifications/`,{headers:{Authorization:`Token ${e}`,"Cache-Control":"no-store"}});if(a.ok){const s=await a.json();n(s)}}catch(e){console.error("Failed to fetch notifications:",e)}};i.useEffect(()=>{r();const e=()=>r();return window.addEventListener("notificationUpdated",e),()=>window.removeEventListener("notificationUpdated",e)},[]);const b=async e=>{n(a=>a.map(s=>s.id===e?{...s,is_read:!0}:s));try{const a=localStorage.getItem("authToken");await fetch(`${l}/api/notifications/read/`,{method:"POST",headers:{Authorization:`Token ${a}`,"Content-Type":"application/json"},body:JSON.stringify({id:e})}),window.dispatchEvent(new Event("notificationUpdated"))}catch(a){console.error("Failed to mark as read",a),r()}},w=async()=>{n(e=>e.map(a=>({...a,is_read:!0})));try{const e=localStorage.getItem("authToken"),a=o.filter(s=>!s.is_read);await Promise.all(a.map(s=>fetch(`${l}/api/notifications/read/`,{method:"POST",headers:{Authorization:`Token ${e}`,"Content-Type":"application/json"},body:JSON.stringify({id:s.id})}))),window.dispatchEvent(new Event("notificationUpdated"))}catch(e){console.error("Failed to mark all as read",e),r()}},j=async(e,a)=>{a&&a.stopPropagation(),n(s=>s.filter(x=>x.id!==e));try{const s=localStorage.getItem("authToken");(await fetch(`${l}/api/notifications/${e}/`,{method:"DELETE",headers:{Authorization:`Token ${s}`}})).ok||console.warn("Delete might not be implemented on backend, hiding locally"),window.dispatchEvent(new Event("notificationUpdated"))}catch(s){console.error("Failed to delete notification",s)}},v=async()=>{n([]),c(!1);try{const e=localStorage.getItem("authToken");await Promise.all(o.map(a=>fetch(`${l}/api/notifications/${a.id}/`,{method:"DELETE",headers:{Authorization:`Token ${e}`}}))),window.dispatchEvent(new Event("notificationUpdated"))}catch(e){console.error("Failed to clear all",e),r()}},m=i.useMemo(()=>{const e=h.trim().toLowerCase();return e?o.filter(a=>(a.message||"").toLowerCase().includes(e)):o},[o,h]),d=o.filter(e=>!e.is_read).length;return t.jsx(y,{children:t.jsxs("div",{className:"min-h-screen bg-slate-50",children:[t.jsx(k,{}),t.jsxs("div",{className:"max-w-5xl mx-auto p-6 space-y-6",children:[t.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold text-slate-900",children:"Notifications"}),t.jsxs("p",{className:"text-slate-500 mt-1",children:["You have ",t.jsx("span",{className:"font-semibold text-blue-600",children:d})," unread messages"]})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs("button",{onClick:w,disabled:d===0,className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors flex items-center gap-2
                  ${d===0?"bg-slate-100 text-slate-400 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700 shadow-sm"}`,children:[t.jsx(f,{className:"w-4 h-4"}),"Mark all read"]}),g?t.jsxs("div",{className:"flex items-center gap-2 bg-red-50 px-3 py-1.5 rounded-lg border border-red-100",children:[t.jsx("span",{className:"text-sm text-red-600 font-medium",children:"Are you sure?"}),t.jsx("button",{onClick:v,className:"px-3 py-1 bg-red-600 text-white text-xs font-bold rounded hover:bg-red-700",children:"Yes"}),t.jsx("button",{onClick:()=>c(!1),className:"px-3 py-1 bg-white text-slate-600 text-xs font-bold rounded border hover:bg-slate-50",children:"No"})]}):t.jsxs("button",{onClick:()=>c(!0),disabled:o.length===0,className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors flex items-center gap-2
                    ${o.length===0?"bg-slate-100 text-slate-400 cursor-not-allowed":"bg-white text-red-600 border border-red-200 hover:bg-red-50"}`,children:[t.jsx(p,{className:"w-4 h-4"}),"Clear all"]})]})]}),t.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden",children:m.length===0?t.jsxs("div",{className:"p-12 text-center text-slate-400",children:[t.jsx("div",{className:"w-16 h-16 bg-slate-50 rounded-full flex items-center justify-center mx-auto mb-4",children:t.jsx(f,{className:"w-8 h-8 text-slate-300"})}),t.jsx("p",{className:"text-lg font-medium text-slate-600",children:"All caught up!"}),t.jsx("p",{className:"text-sm",children:"No notifications to display"})]}):t.jsx("div",{className:"divide-y divide-slate-100",children:m.map(e=>t.jsxs("div",{onClick:()=>b(e.id),className:`p-4 hover:bg-slate-50 transition-colors cursor-pointer group flex gap-4 items-start
                      ${e.is_read?"":"bg-blue-50/50"}`,children:[t.jsx("div",{className:`mt-2 w-2 h-2 rounded-full flex-shrink-0 
                      ${e.is_read?"bg-transparent":"bg-blue-600"}`}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("p",{className:`text-sm ${e.is_read?"text-slate-600":"font-semibold text-slate-900"}`,children:e.message}),t.jsx("p",{className:"text-xs text-slate-400 mt-1",children:new Date(e.created_at).toLocaleString()})]}),t.jsx("button",{onClick:a=>j(e.id,a),className:"p-2 text-slate-400 hover:text-red-600 hover:bg-red-50 rounded-full opacity-0 group-hover:opacity-100 transition-all",title:"Delete notification",children:t.jsx(p,{className:"w-4 h-4"})})]},e.id))})})]})]})})}N.createRoot(document.getElementById("root")).render(t.jsx(i.StrictMode,{children:t.jsx(C,{})}));
