import{j as e,R as ge,a as n,A as be,b as ye}from"./index-BY_FY2h5.js";import{N as fe}from"./navigation-BPz6xB7x.js";import{L as Ne}from"./language-context-CIojU0iR.js";function je({order:d}){const c=d||{};return e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-8 print:shadow-none print:border-0 text-black font-sans min-h-[29.7cm] relative",children:[e.jsxs("div",{className:"flex justify-between items-start mb-6",children:[e.jsx("div",{className:"w-2/3",children:e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"w-10 h-10 bg-[#3D56A6] text-white flex items-center justify-center font-bold text-lg rounded-sm",children:"EIT"}),e.jsx("div",{className:"text-[#3D56A6] text-xl font-bold",children:"Lasertechnik"})]})}),e.jsxs("div",{className:"w-1/3 flex flex-col items-end",children:[e.jsx("div",{className:"text-right font-bold text-xl",children:"JOB ORDER"}),e.jsx("div",{className:"text-right font-bold text-lg mb-2",children:"ใบรับงาน"}),e.jsxs("div",{className:"border border-black flex",children:[e.jsx("div",{className:"bg-gray-100 border-r border-black px-2 py-1 text-xs font-bold flex items-center",children:"เลขที่เอกสาร"}),e.jsx("div",{className:"px-4 py-1 font-bold text-lg min-w-[100px] text-center",children:c.jobOrderCode||c.ref||"-"})]})]})]}),e.jsxs("div",{className:"border border-black mb-4",children:[e.jsxs("div",{className:"flex border-b border-black",children:[e.jsxs("div",{className:"w-1/2 border-r border-black p-2",children:[e.jsx("div",{className:"text-[10px] font-bold",children:"ชื่อลูกค้า :"}),e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Customer Name"}),e.jsx("div",{className:"font-semibold pl-2",children:c.customer||"-"})]}),e.jsxs("div",{className:"w-1/4 border-r border-black p-2",children:[e.jsx("div",{className:"text-[10px] font-bold",children:"วันที่เริ่มทำงาน :"}),e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Start Date"}),e.jsx("div",{className:"font-semibold pl-2",children:c.start?new Date(c.start).toLocaleDateString():"-"})]}),e.jsxs("div",{className:"w-1/4 p-2",children:[e.jsx("div",{className:"text-[10px] font-bold",children:"จำนวนที่ส่งทำชิ้นงาน :"}),e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Order Quantity"}),e.jsx("div",{className:"font-semibold pl-2",children:c.totalQuantity||"-"})]})]}),e.jsxs("div",{className:"flex border-b border-black",children:[e.jsxs("div",{className:"w-1/2 border-r border-black p-2",children:[e.jsx("div",{className:"text-[10px] font-bold",children:"ชื่อสินค้า/ชิ้นงาน :"}),e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Product No."}),e.jsx("div",{className:"font-semibold pl-2",children:c.productNo||"-"})]}),e.jsxs("div",{className:"w-1/2 p-2",children:[e.jsx("div",{className:"text-[10px] font-bold",children:"วันที่ทำชิ้นงานเสร็จ :"}),e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Completed Date"}),e.jsx("div",{className:"font-semibold pl-2",children:c.completedDate?new Date(c.completedDate).toLocaleDateString():"-"})]})]}),e.jsxs("div",{className:"flex",children:[e.jsxs("div",{className:"w-1/2 border-r border-black p-2",children:[e.jsx("div",{className:"text-[10px] font-bold",children:"ผู้รับผิดชอบ :"}),e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Responsible"}),e.jsx("div",{className:"font-semibold pl-2",children:c.responsible||"-"})]}),e.jsxs("div",{className:"w-1/2 p-2",children:[e.jsx("div",{className:"text-[10px] font-bold",children:"ระยะเวลาที่ใช้ :"}),e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Time of Production"}),e.jsx("div",{className:"font-semibold pl-2",children:c.productionTime||"-"})]})]})]}),e.jsx("div",{className:"border border-black border-t-0 mb-4",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-black bg-gray-50",children:[e.jsxs("th",{className:"border-r border-black p-2 text-center w-1/4",children:[e.jsx("div",{className:"font-bold",children:"รหัสสินค้า"}),e.jsx("div",{className:"text-xs font-normal",children:"Item Code"})]}),e.jsxs("th",{className:"border-r border-black p-2 text-center w-1/2",children:[e.jsx("div",{className:"font-bold",children:"รายละเอียด"}),e.jsx("div",{className:"text-xs font-normal",children:"Description"})]}),e.jsxs("th",{className:"border-r border-black p-2 text-center w-1/8",children:[e.jsx("div",{className:"font-bold",children:"จำนวน"}),e.jsx("div",{className:"text-xs font-normal",children:"Quantity"})]}),e.jsxs("th",{className:"p-2 text-center w-1/8",children:[e.jsx("div",{className:"font-bold",children:"หน่วยนับ"}),e.jsx("div",{className:"text-xs font-normal",children:"Unit"})]})]})}),e.jsxs("tbody",{children:[e.jsxs("tr",{className:"border-b border-dashed border-gray-300",children:[e.jsx("td",{className:"border-r border-black p-3 align-top",children:c.productNo||"-"}),e.jsx("td",{className:"border-r border-black p-3 align-top",children:c.product||"-"}),e.jsx("td",{className:"border-r border-black p-3 text-right align-top",children:c.quantity||"-"}),e.jsx("td",{className:"p-3 text-center align-top",children:c.unit||"-"})]}),Array.from({length:15}).map((P,p)=>e.jsxs("tr",{className:"border-b border-dashed border-gray-300 last:border-b-0",children:[e.jsx("td",{className:"border-r border-black p-3 h-8"}),e.jsx("td",{className:"border-r border-black p-3"}),e.jsx("td",{className:"border-r border-black p-3"}),e.jsx("td",{className:"p-3"})]},`empty-${p}`))]})]})})]})}function ve(){const[d,c]=n.useState(()=>{try{return JSON.parse(localStorage.getItem("mfgOrders")||"[]")}catch{return[]}}),[P,p]=n.useState(null),[we,Se]=n.useState(null),[Ce,ke]=n.useState(null),[Oe,De]=n.useState(""),[Ie,Ae]=n.useState(""),[W,h]=n.useState(!1),[l,u]=n.useState({product:"",productNo:"",jobOrderCode:"",purchaseOrder:"",unit:"Unit",quantity:1,totalQuantity:1,scheduledDate:"",completedDate:"",productionTime:"",responsible:"",priority:"None",customer:""}),[G,C]=n.useState(null),[M,g]=n.useState(""),[Y,k]=n.useState(null),[Q,b]=n.useState(""),[X,O]=n.useState(null),[q,y]=n.useState(""),[H,f]=n.useState(null),[Z,D]=n.useState(null),[T,N]=n.useState(""),[ee,I]=n.useState(null),[L,j]=n.useState(""),[R,v]=n.useState(null),[J,A]=n.useState(null),[te,F]=n.useState(!1),[B,V]=n.useState("default"),[re,E]=n.useState(null),[w,S]=n.useState(""),[Ee,Pe]=n.useState(null),[Me,Qe]=n.useState(null),[qe,Te]=n.useState(null);n.useRef(null);const[Le,Je]=n.useState(null),[Fe,Be]=n.useState(null),[Ke,se]=n.useState([]),[_e,He]=n.useState(!1),[$,Re]=n.useState(null),[K,ae]=n.useState([]),[le,_]=n.useState(!1),[ne,ie]=n.useState([]),de=n.useCallback(t=>{const r=String(t||"").trim();let s={...l,purchaseOrder:r};const a=K.find(i=>String(i.poNumber||"").trim()===r);if(a){const i=String(a.customer&&(a.customer.company||a.customer.name)||"").trim();i&&(s.customer=i);const m=Array.isArray(a.items)&&a.items.length?a.items[0]:null;if(m){String(s.product||"").trim()||(s.product=String(m.product||m.description||"").trim());const x=Number(m.qty);!Number(s.quantity)&&Number.isFinite(x)&&x>0&&(s.quantity=x)}}else{const i=d.find(m=>String(m.ref||"").trim()===r);if(i){String(i.customer||"").trim()&&(s.customer=i.customer),!String(s.product||"").trim()&&String(i.product||"").trim()&&(s.product=i.product),!String(s.productNo||"").trim()&&String(i.productNo||"").trim()&&(s.productNo=i.productNo);const m=Number(i.quantity),x=Number(i.totalQuantity);!Number(s.quantity)&&Number.isFinite(m)&&m>0&&(s.quantity=m),!Number(s.totalQuantity)&&Number.isFinite(x)&&x>0&&(s.totalQuantity=x)}}u(s),_(!1)},[l,K,d]);n.useEffect(()=>{try{const t=JSON.parse(localStorage.getItem("inventoryProducts")||"[]");Array.isArray(t)&&se(t)}catch{}},[]),n.useEffect(()=>{try{const t=JSON.parse(localStorage.getItem("poList")||"[]");Array.isArray(t)&&ae(t)}catch{}},[]),n.useEffect(()=>{(async()=>{try{const t=localStorage.getItem("authToken"),r=t?{Authorization:`Token ${t}`}:{},s=await fetch(`${be}/api/deals/`,{headers:r});if(!s.ok)return;const a=await s.json(),i=Array.from(new Set((a||[]).map(m=>String(m.po_number||"").trim()).filter(Boolean)));ie(i)}catch{}})()},[]),n.useEffect(()=>{if(!d.length){const t=[{id:1,ref:"WH/MO/00001",jobOrderCode:"JO-001",start:new Date(Date.now()-1728e5).toISOString(),product:"Laser Cladding Machine",nextActivity:"",customer:"Big C Supercenter PLC",componentStatus:"",quantity:1,totalQuantity:1,state:"",favorite:!1,selected:!1},{id:2,ref:"WH/MO/00002",jobOrderCode:"JO-002",start:new Date(Date.now()-864e5).toISOString(),product:"Laser Welding Machine",nextActivity:"",customer:"SIANGHAI EITING TRADING COMPANY",componentStatus:"",quantity:1,totalQuantity:1,state:"",favorite:!0,selected:!1},{id:3,ref:"WH/MO/00003",jobOrderCode:"JO-003",start:new Date().toISOString(),product:"Cake",nextActivity:"",customer:"METRO MACHINERY",componentStatus:"",quantity:10,totalQuantity:10,state:"",favorite:!1,selected:!1},{id:4,ref:"WH/MO/00004",jobOrderCode:"JO-004",start:new Date().toISOString(),product:"mohinga",nextActivity:"",customer:"Konvy",componentStatus:"",quantity:5,totalQuantity:5,state:"",favorite:!1,selected:!1}];c(t),localStorage.setItem("mfgOrders",JSON.stringify(t))}},[]),n.useEffect(()=>{try{const t=JSON.parse(localStorage.getItem("mfgPreFill")||"null");t&&t.product&&(u(r=>({...r,product:t.product||t.sku||r.product,quantity:Number(t.quantity)||1})),h(!0),localStorage.removeItem("mfgPreFill"))}catch{}},[]);const o=t=>{c(t),localStorage.setItem("mfgOrders",JSON.stringify(t))},oe=t=>o(d.map(r=>r.id===t?{...r,selected:!r.selected}:r)),ce=d.reduce((t,r)=>t+(parseInt(r.quantity,10)||0),0),ue=d.reduce((t,r)=>t+(parseInt(r.totalQuantity,10)||0),0),me=t=>{const r=new Date(t),a=Math.floor((new Date().setHours(0,0,0,0)-new Date(r).setHours(0,0,0,0))/(24*60*60*1e3));return a<=0?"Today":a===1?"Yesterday":`${a} days ago`},xe=t=>t==="Processing"?"bg-blue-50 text-[#2D4485]":t==="Finished"?"bg-green-100 text-green-700":t==="Cancelled"?"bg-red-100 text-red-700":"bg-gray-200 text-gray-700",pe=t=>t==="Not Available"?"bg-red-100 text-red-700":t==="Available"?"bg-green-100 text-green-700":"bg-gray-200 text-gray-700",he=t=>t==="High"?"bg-red-500 text-white ring-2 ring-red-100":t==="Medium"?"bg-orange-400 text-white ring-2 ring-orange-100":t==="Low"?"bg-[#2D4485] text-white ring-2 ring-blue-100":"bg-slate-400 text-white ring-2 ring-slate-200",z=t=>t==="High"?3:t==="Medium"?2:t==="Low"?1:0,U=t=>t?new Date(t).toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"}):"";return e.jsxs("main",{className:"min-h-screen bg-white",children:[e.jsx(fe,{}),e.jsx("section",{className:"w-full py-8 px-4 sm:px-6 lg:px-8 bg-gradient-to-b from-gray-50 to-white",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsx("div",{className:"mb-6 flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:"Manufacturing Order"}),e.jsx("button",{className:"inline-flex items-center justify-center min-w-[150px] btn-pill",title:"New MO",onClick:()=>h(!0),children:"New MO"}),e.jsxs("div",{className:"relative",children:[e.jsx("button",{className:"btn-pill shadow-sm",title:"Sort and group",onClick:()=>F(t=>!t),children:"Sort ▾"}),te&&e.jsxs("div",{className:"absolute z-20 mt-2 bg-white border border-gray-200 rounded-lg shadow-lg py-1 min-w-[160px]",children:[e.jsx("button",{className:`block w-full text-left px-3 py-2 text-sm hover:bg-gray-50 ${B==="default"?"text-[#3D56A6] font-semibold":""}`,onClick:()=>{V("default"),F(!1)},children:"Default"}),e.jsx("button",{className:`block w-full text-left px-3 py-2 text-sm hover:bg-gray-50 ${B==="priority"?"text-[#3D56A6] font-semibold":""}`,onClick:()=>{V("priority"),F(!1)},children:"By Priority"})]})]}),e.jsx("button",{className:"btn-pill",title:"Component",onClick:()=>window.location.href="/products.html",children:"Component"}),e.jsx("button",{className:"btn-pill",title:"Bill of Materials",onClick:()=>window.location.href="/bom.html",children:"Bill of Materials"})]})}),e.jsx("div",{className:"bg-white border border-gray-200 rounded-xl overflow-x-auto shadow-sm",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-gray-700 bg-gray-50",children:[e.jsx("th",{className:"p-3 w-8"}),e.jsx("th",{className:"p-3 text-left font-medium",children:"Priority"}),e.jsx("th",{className:"p-3 text-left font-medium",children:"Job Order"}),e.jsx("th",{className:"p-3 text-left font-medium",children:"Purchase Order"}),e.jsx("th",{className:"p-3 text-left font-medium",children:"Item code"}),e.jsx("th",{className:"p-3 text-left font-medium",children:"Product"}),e.jsx("th",{className:"p-3 text-left font-medium",children:"Unit"}),e.jsx("th",{className:"p-3 text-right font-medium",children:"Quantity"}),e.jsx("th",{className:"p-3 text-right font-medium",children:"Total Quantity"}),e.jsx("th",{className:"p-3 text-left font-medium",children:"Start"}),e.jsx("th",{className:"p-3 text-left font-medium",children:"Completed Date"}),e.jsx("th",{className:"p-3 text-left font-medium",children:"Production Time"}),e.jsx("th",{className:"p-3 text-left font-medium",children:"Responsible"}),e.jsx("th",{className:"p-3 text-left font-medium",children:"Customer"}),e.jsx("th",{className:"p-3 text-left font-medium",children:"Component Status"}),e.jsx("th",{className:"p-3 text-left font-medium",children:"State"}),e.jsx("th",{className:"p-3 w-8"})]})}),e.jsx("tbody",{children:[...d].sort((t,r)=>{if(B==="priority"){const s=z(t.priority);return z(r.priority)-s||String(t.ref).localeCompare(String(r.ref))}return String(t.ref).localeCompare(String(r.ref))}).map(t=>e.jsxs("tr",{className:"border-t hover:bg-gray-50",children:[e.jsx("td",{className:"p-3 text-center",children:e.jsx("input",{type:"checkbox",checked:t.selected,onChange:()=>oe(t.id)})}),e.jsx("td",{className:"p-3",children:e.jsxs("div",{className:"relative inline-block",children:[e.jsx("button",{className:`${he(t.priority)} px-2 py-1 rounded-full text-xs`,onClick:()=>v(R===t.id?null:t.id),title:"Change priority",children:t.priority&&t.priority!=="None"?t.priority:"Set Priority"}),R===t.id&&e.jsxs("div",{className:"absolute z-10 mt-2 bg-white border border-gray-200 rounded-md shadow-md",children:[e.jsx("button",{className:"block w-full text-left px-3 py-2 text-sm hover:bg-gray-50 text-yellow-700",onClick:()=>{v(null),o(d.map(r=>r.id===t.id?{...r,priority:"Low"}:r))},children:"Low"}),e.jsx("button",{className:"block w-full text-left px-3 py-2 text-sm hover:bg-gray-50 text-orange-700",onClick:()=>{v(null),o(d.map(r=>r.id===t.id?{...r,priority:"Medium"}:r))},children:"Medium"}),e.jsx("button",{className:"block w-full text-left px-3 py-2 text-sm hover:bg-gray-50 text-red-700",onClick:()=>{v(null),o(d.map(r=>r.id===t.id?{...r,priority:"High"}:r))},children:"High"}),e.jsx("button",{className:"block w-full text-left px-3 py-2 text-sm hover:bg-gray-50",onClick:()=>{v(null),o(d.map(r=>r.id===t.id?{...r,priority:"None"}:r))},children:"Clear"})]})]})}),e.jsx("td",{className:"p-3",children:X===t.id?e.jsx("input",{autoFocus:!0,value:q,onChange:r=>y(r.target.value),onBlur:()=>{const r=q.trim(),s=d.map(a=>a.id===t.id?{...a,jobOrderCode:r}:a);o(s),O(null),y("")},onKeyDown:r=>{if(r.key==="Enter"){r.preventDefault();const s=q.trim(),a=d.map(i=>i.id===t.id?{...i,jobOrderCode:s}:i);o(a),O(null),y("")}else r.key==="Escape"&&(O(null),y(""))},className:"w-32 rounded-md border border-gray-300 px-2 py-1"}):e.jsx("button",{className:"text-[#3D56A6] hover:underline",onClick:()=>{O(t.id),y(t.jobOrderCode||"")},title:"Edit Job Order",children:t.jobOrderCode||"-"})}),e.jsx("td",{className:"p-3",children:e.jsx("a",{className:"text-[#3D56A6] hover:underline font-medium",href:"#",children:t.ref})}),e.jsx("td",{className:"p-3 text-gray-700",children:t.productNo||"-"}),e.jsx("td",{className:"p-3",children:Y===t.id?e.jsx("input",{autoFocus:!0,value:Q,onChange:r=>b(r.target.value),onBlur:()=>{const r=Q.trim(),s=d.map(a=>a.id===t.id?{...a,product:r||"Untitled"}:a);o(s),k(null),b("")},onKeyDown:r=>{if(r.key==="Enter"){r.preventDefault();const s=Q.trim(),a=d.map(i=>i.id===t.id?{...i,product:s||"Untitled"}:i);o(a),k(null),b("")}else r.key==="Escape"&&(k(null),b(""))},className:"w-72 rounded-md border border-gray-300 px-2 py-1",placeholder:"Add product"}):e.jsx("button",{className:"text-[#3D56A6] hover:underline",onClick:()=>{k(t.id),b(t.product||"")},title:"Edit product",children:t.product||"Add product"})}),e.jsx("td",{className:"p-3 text-right",children:Z===t.id?e.jsx("input",{autoFocus:!0,type:"number",min:"0",step:"1",value:T,onChange:r=>N(r.target.value),onBlur:()=>{const r=Math.max(0,Math.floor(Number(T||0))),s=d.map(a=>a.id===t.id?{...a,quantity:r}:a);o(s),D(null),N("")},onKeyDown:r=>{if(r.key==="Enter"){r.preventDefault();const s=Math.max(0,Math.floor(Number(T||0))),a=d.map(i=>i.id===t.id?{...i,quantity:s}:i);o(a),D(null),N("")}else r.key==="Escape"&&(D(null),N(""))},className:"w-24 rounded-md border border-gray-300 px-2 py-1 text-right bg-white",placeholder:"0"}):e.jsx("button",{className:"text-[#3D56A6] font-medium hover:underline",onClick:()=>{D(t.id),N(String(parseInt(t.quantity,10)||0))},title:"Edit quantity",children:String(parseInt(t.quantity,10)||0)})}),e.jsx("td",{className:"p-3 text-gray-700",children:t.unit||"Unit"}),e.jsx("td",{className:"p-3 text-right",children:ee===t.id?e.jsx("input",{autoFocus:!0,type:"number",min:"0",step:"1",value:L,onChange:r=>j(r.target.value),onBlur:()=>{const r=Math.max(0,Math.floor(Number(L||0))),s=d.map(a=>a.id===t.id?{...a,totalQuantity:r}:a);o(s),I(null),j("")},onKeyDown:r=>{if(r.key==="Enter"){r.preventDefault();const s=Math.max(0,Math.floor(Number(L||0))),a=d.map(i=>i.id===t.id?{...i,totalQuantity:s}:i);o(a),I(null),j("")}else r.key==="Escape"&&(I(null),j(""))},className:"w-24 rounded-md border border-gray-300 px-2 py-1 text-right bg-white",placeholder:"0"}):e.jsx("button",{className:"text-[#3D56A6] font-medium hover:underline",onClick:()=>{I(t.id),j(String(parseInt(t.totalQuantity,10)||0))},title:"Edit total quantity",children:String(parseInt(t.totalQuantity,10)||0)})}),e.jsx("td",{className:"p-3",children:re===t.id?e.jsx("input",{autoFocus:!0,type:"datetime-local",value:w,onChange:r=>S(r.target.value),onBlur:()=>{const r=w?new Date(w).toISOString():t.start,s=d.map(a=>a.id===t.id?{...a,start:r}:a);o(s),E(null),S("")},onKeyDown:r=>{if(r.key==="Enter"){r.preventDefault();const s=w?new Date(w).toISOString():t.start,a=d.map(i=>i.id===t.id?{...i,start:s}:i);o(a),E(null),S("")}else r.key==="Escape"&&(E(null),S(""))},className:"w-56 rounded-md border border-gray-300 px-2 py-1"}):e.jsx("button",{className:"text-gray-700 hover:underline",onClick:()=>{const r=(t.start||"").slice(0,16);E(t.id),S(r)},title:"Edit start",children:t.start?U(new Date(t.start).getTime()):me(t.start)})}),e.jsx("td",{className:"p-3 text-gray-700",children:t.completedDate?U(new Date(t.completedDate).getTime()):"-"}),e.jsx("td",{className:"p-3 text-gray-700",children:t.productionTime||"-"}),e.jsx("td",{className:"p-3 text-gray-700",children:t.responsible||"-"}),e.jsx("td",{className:"p-3",children:G===t.id?e.jsx("input",{autoFocus:!0,value:M,onChange:r=>g(r.target.value),onBlur:()=>{const r=M.trim(),s=d.map(a=>a.id===t.id?{...a,customer:r}:a);o(s),C(null),g("")},onKeyDown:r=>{if(r.key==="Enter"){r.preventDefault();const s=M.trim(),a=d.map(i=>i.id===t.id?{...i,customer:s}:i);o(a),C(null),g("")}else r.key==="Escape"&&(C(null),g(""))},className:"w-72 rounded-md border border-gray-300 px-2 py-1",placeholder:"Add customer"}):e.jsx("button",{className:`text-left ${t.customer?"text-gray-800":"text-gray-400"} hover:underline`,onClick:()=>{C(t.id),g(t.customer||"")},title:"Edit customer",children:t.customer||"Add customer"})}),e.jsx("td",{className:"p-3",children:e.jsxs("div",{className:"relative inline-block",children:[e.jsx("button",{className:`${pe(t.componentStatus)} px-2 py-1 rounded-full text-xs`,onClick:()=>p(P===t.id?null:t.id),title:"Change component status",children:t.componentStatus||"Set Status"}),P===t.id&&e.jsxs("div",{className:"absolute z-10 mt-2 bg-white border border-gray-200 rounded-md shadow-md",children:[e.jsx("button",{className:"block w-full text-left px-3 py-2 text-sm hover:bg-gray-50 text-green-700",onClick:()=>{p(null),o(d.map(r=>r.id===t.id?{...r,componentStatus:"Available"}:r))},children:"Available"}),e.jsx("button",{className:"block w-full text-left px-3 py-2 text-sm hover:bg-gray-50 text-red-600",onClick:()=>{p(null),o(d.map(r=>r.id===t.id?{...r,componentStatus:"Not Available"}:r))},children:"Not Available"}),e.jsx("button",{className:"block w-full text-left px-3 py-2 text-sm hover:bg-gray-50",onClick:()=>{p(null),o(d.map(r=>r.id===t.id?{...r,componentStatus:""}:r))},children:"Clear"})]})]})}),e.jsx("td",{className:"p-3",children:e.jsxs("div",{className:"relative inline-block",children:[e.jsx("button",{className:`${xe(t.state)} px-2 py-1 rounded-full text-xs`,onClick:()=>f(H===t.id?null:t.id),title:"Change state",children:t.state||"Set State"}),H===t.id&&e.jsxs("div",{className:"absolute z-10 mt-2 bg-white border border-gray-200 rounded-md shadow-md",children:[e.jsx("button",{className:"block w-full text-left px-3 py-2 text-sm hover:bg-gray-50",onClick:()=>{f(null),o(d.map(r=>r.id===t.id?{...r,state:"Processing"}:r))},children:"Processing"}),e.jsx("button",{className:"block w-full text-left px-3 py-2 text-sm hover:bg-gray-50 text-green-700",onClick:()=>{f(null),o(d.map(r=>r.id===t.id?{...r,state:"Finished"}:r))},children:"Finished"}),e.jsx("button",{className:"block w-full text-left px-3 py-2 text-sm hover:bg-gray-50 text-red-600",onClick:()=>{f(null),o(d.map(r=>r.id===t.id?{...r,state:"Cancelled"}:r))},children:"Cancelled"}),e.jsx("button",{className:"block w-full text-left px-3 py-2 text-sm hover:bg-gray-50",onClick:()=>{f(null),o(d.map(r=>r.id===t.id?{...r,state:""}:r))},children:"Clear"})]})]})}),e.jsx("td",{className:"p-3 text-center",children:e.jsx("div",{className:"relative inline-block",children:e.jsx("button",{"aria-label":"Delete order",className:"w-8 h-8 flex items-center justify-center rounded-md border border-gray-300 bg-white text-gray-900 hover:bg-gray-900 hover:text-white shadow-sm",onClick:()=>A(J===t.id?null:t.id),title:"Delete order",children:e.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("polyline",{points:"3 6 5 6 21 6"}),e.jsx("path",{d:"M19 6l-1 14a2 2 0 0 1-2 2H8a2 2 0 0 1-2-2L5 6"}),e.jsx("path",{d:"M10 11v6"}),e.jsx("path",{d:"M14 11v6"}),e.jsx("path",{d:"M9 6V4a2 2 0 0 1 2-2h2a2 2 0 0 1 2 2v2"})]})})})})]},t.id))}),e.jsx("tfoot",{children:e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{className:"p-3",colSpan:7}),e.jsx("td",{className:"p-3 text-right font-bold text-gray-900",children:String(parseInt(ce,10)||0)}),e.jsx("td",{className:"p-3"}),e.jsx("td",{className:"p-3 text-right font-bold text-gray-900",children:String(parseInt(ue,10)||0)}),e.jsx("td",{className:"p-3",colSpan:8})]})})]})})]})}),J&&e.jsx("div",{className:"fixed inset-0 bg-black/30 z-40",onClick:()=>A(null),children:e.jsx("div",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 w-[360px]",onClick:t=>t.stopPropagation(),children:e.jsxs("div",{className:"bg-white rounded-xl shadow-lg border-2 border-white",children:[e.jsx("div",{className:"px-4 py-3 border-b-2 border-white",children:e.jsx("h3",{className:"font-semibold text-gray-900",children:"Confirm Delete"})}),e.jsx("div",{className:"p-4",children:e.jsx("div",{className:"text-sm text-gray-800",children:"Delete this order?"})}),e.jsxs("div",{className:"px-4 py-3 border-t border-gray-200 flex items-center justify-end gap-2",children:[e.jsx("button",{className:"px-3 py-2 rounded-md border border-gray-300 text-gray-700 hover:bg-gray-50",onClick:()=>A(null),children:"Cancel"}),e.jsx("button",{className:"px-4 py-2 rounded-md bg-[#2D4485] text-white hover:bg-[#3D56A6]",onClick:()=>{o(d.filter(t=>t.id!==J)),A(null)},children:"Delete"})]})]})})}),W&&e.jsx("div",{className:"fixed inset-0 bg-black/30 z-30",onClick:()=>h(!1),children:e.jsx("div",{className:"absolute left-1/2 top-20 -translate-x-1/2 w-[960px] max-w-[95vw]",onClick:t=>t.stopPropagation(),children:e.jsxs("div",{className:"bg-white rounded-xl shadow-lg border border-gray-200",children:[e.jsxs("div",{className:"px-4 py-3 border-b border-gray-200 flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center gap-3",children:e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"New Manufacturing Order"})}),e.jsx("button",{className:"text-gray-500 hover:text-gray-900",onClick:()=>h(!1),children:"✕"})]}),e.jsx("div",{className:"p-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-10 gap-y-3",children:[e.jsxs("div",{className:"grid grid-cols-[160px_1fr] items-center gap-3",children:[e.jsx("div",{className:"text-sm text-gray-700",children:"Job Order Code"}),e.jsx("input",{value:l.jobOrderCode,onChange:t=>u({...l,jobOrderCode:t.target.value}),placeholder:"e.g. JO-001",className:"w-full border-b border-gray-300 px-2 py-1 focus:outline-none"})]}),e.jsxs("div",{className:"grid grid-cols-[160px_1fr] items-center gap-3",children:[e.jsx("div",{className:"text-sm text-gray-700",children:"Purchase Order"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{value:l.purchaseOrder,onChange:t=>{u({...l,purchaseOrder:t.target.value}),_(!0)},onFocus:()=>_(!0),placeholder:"e.g. PO-1234",className:"w-full border-b border-gray-300 px-2 py-1 focus:outline-none"}),le&&l.purchaseOrder&&(()=>{const t=l.purchaseOrder.toLowerCase(),r=Array.from(new Set([...d.map(s=>String(s.ref||"").trim()).filter(Boolean),...K.map(s=>String(s.poNumber||"").trim()).filter(Boolean),...ne])).filter(s=>s.toLowerCase().includes(t)).slice(0,8);return r.length?e.jsx("div",{className:"absolute left-0 right-0 top-full mt-1 bg-white border border-gray-200 rounded-lg shadow-lg z-20 max-h-48 overflow-y-auto",children:r.map((s,a)=>e.jsx("button",{className:"w-full text-left px-3 py-2 text-sm hover:bg-gray-50 text-gray-700",onClick:()=>de(s),children:s},`${s}-${a}`))}):null})()]})]}),e.jsxs("div",{className:"grid grid-cols-[160px_1fr] items-center gap-3",children:[e.jsx("div",{className:"text-sm text-gray-700",children:"Item code"}),e.jsx("input",{value:l.productNo,onChange:t=>u({...l,productNo:t.target.value}),placeholder:"e.g. LCM-001",className:"w-full border-b border-gray-300 px-2 py-1 focus:outline-none"})]}),e.jsxs("div",{className:"grid grid-cols-[160px_1fr] items-center gap-3",children:[e.jsx("div",{className:"text-sm text-gray-700",children:"Product"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{value:l.product,onChange:t=>u({...l,product:t.target.value}),placeholder:"Product to build...",className:"w-full border-b border-gray-300 px-2 py-1 focus:outline-none"}),e.jsx("button",{className:"btn-pill px-3",children:"▾"})]})]}),e.jsxs("div",{className:"grid grid-cols-[160px_1fr] items-center gap-3",children:[e.jsx("div",{className:"text-sm text-gray-700",children:"Unit"}),e.jsx("input",{value:l.unit,onChange:t=>u({...l,unit:t.target.value}),className:"w-28 rounded-md border border-gray-300 px-2 py-1"})]}),e.jsxs("div",{className:"grid grid-cols-[160px_1fr] items-center gap-3",children:[e.jsx("div",{className:"text-sm text-gray-700",children:"Quantity"}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsx("input",{type:"number",value:l.quantity,onChange:t=>u({...l,quantity:Number(t.target.value)}),className:"w-28 rounded-md border border-gray-300 px-2 py-1"})})]}),e.jsxs("div",{className:"grid grid-cols-[160px_1fr] items-center gap-3",children:[e.jsx("div",{className:"text-sm text-gray-700",children:"Total Quantity"}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsx("input",{type:"number",value:l.totalQuantity,onChange:t=>u({...l,totalQuantity:Number(t.target.value)}),className:"w-28 rounded-md border border-gray-300 px-2 py-1"})})]}),e.jsxs("div",{className:"grid grid-cols-[160px_1fr] items-center gap-3",children:[e.jsx("div",{className:"text-sm text-gray-700",children:"Start Date"}),e.jsx("input",{type:"datetime-local",value:l.scheduledDate,onChange:t=>u({...l,scheduledDate:t.target.value}),className:"w-64 rounded-md border border-gray-300 px-2 py-1"})]}),e.jsxs("div",{className:"grid grid-cols-[160px_1fr] items-center gap-3",children:[e.jsx("div",{className:"text-sm text-gray-700",children:"Completed Date"}),e.jsx("input",{type:"datetime-local",value:l.completedDate,onChange:t=>u({...l,completedDate:t.target.value}),className:"w-64 rounded-md border border-gray-300 px-2 py-1"})]}),e.jsxs("div",{className:"grid grid-cols-[160px_1fr] items-center gap-3",children:[e.jsx("div",{className:"text-sm text-gray-700",children:"Production Time"}),e.jsx("input",{value:l.productionTime,onChange:t=>u({...l,productionTime:t.target.value}),placeholder:"e.g. 2 Days",className:"w-64 rounded-md border border-gray-300 px-2 py-1"})]}),e.jsxs("div",{className:"grid grid-cols-[160px_1fr] items-center gap-3",children:[e.jsx("div",{className:"text-sm text-gray-700",children:"Responsible"}),e.jsx("input",{value:l.responsible,onChange:t=>u({...l,responsible:t.target.value}),placeholder:"Person responsible",className:"w-64 rounded-md border border-gray-300 px-2 py-1"})]}),e.jsxs("div",{className:"grid grid-cols-[160px_1fr] items-center gap-3",children:[e.jsx("div",{className:"text-sm text-gray-700",children:"Customer Company"}),e.jsx("input",{value:l.customer,onChange:t=>u({...l,customer:t.target.value}),placeholder:"Add customer company",className:"w-64 rounded-md border border-gray-300 px-2 py-1"})]}),e.jsxs("div",{className:"grid grid-cols-[160px_1fr] items-center gap-3",children:[e.jsx("div",{className:"text-sm text-gray-700",children:"Priority"}),e.jsxs("select",{value:l.priority,onChange:t=>u({...l,priority:t.target.value}),className:"w-64 rounded-md border border-gray-300 px-2 py-1",children:[e.jsx("option",{value:"None",children:"None"}),e.jsx("option",{value:"Low",children:"Low"}),e.jsx("option",{value:"Medium",children:"Medium"}),e.jsx("option",{value:"High",children:"High"})]})]})]})}),e.jsxs("div",{className:"px-4 py-3 border-t border-gray-200 flex items-center justify-end gap-2",children:[e.jsx("button",{className:"btn-pill",onClick:()=>h(!1),children:"Cancel"}),e.jsx("button",{className:"btn-pill",onClick:()=>{var a;const t=l.purchaseOrder&&l.purchaseOrder.trim()?l.purchaseOrder.trim():`WH/MO/${String((((a=d[0])==null?void 0:a.id)||0)+1).padStart(5,"0")}`,s=[{id:Date.now(),ref:t,jobOrderCode:l.jobOrderCode||"",start:l.scheduledDate||new Date().toISOString(),productNo:l.productNo||"",product:l.product||"Untitled",unit:l.unit||"Unit",completedDate:l.completedDate||"",productionTime:l.productionTime||"",responsible:l.responsible||"",nextActivity:"",customer:l.customer||"",componentStatus:"",quantity:Number(l.quantity)||1,totalQuantity:Number(l.totalQuantity)||1,state:"",priority:l.priority||"None",favorite:!1,selected:!1},...d];c(s),localStorage.setItem("mfgOrders",JSON.stringify(s)),h(!1)},children:"Add"})]})]})})}),$&&ye.createPortal(e.jsxs("div",{className:"print-portal",children:[e.jsx("style",{children:`
              @media print {
                body > *:not(.print-portal) { display: none !important; }
                .print-portal { 
                  display: block !important; 
                  position: absolute; 
                  top: 0; 
                  left: 0; 
                  width: 100%; 
                  background: white; 
                  z-index: 9999;
                }
                @page { margin: 0; size: auto; }
              }
              .print-portal { display: none; }
            `}),e.jsx(je,{order:$})]}),document.body)]})}ge.createRoot(document.getElementById("root")).render(e.jsx(n.StrictMode,{children:e.jsx(Ne,{children:e.jsx(ve,{})})}));
